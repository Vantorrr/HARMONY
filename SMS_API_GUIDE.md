# üì± SMS API - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéØ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ SMS –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –¶–µ–Ω—Ç—Ä–∞ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–µ–±–µ–Ω–∫–∞ "–ì–ê–†–ú–û–ù–ò–Ø". 

**‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

---

## üìã API Endpoints

### 1. üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ SMS

**POST** `/api/sms/send`

```json
{
  "phone": "79991234567"
}
```

**–û—Ç–≤–µ—Ç —É—Å–ø–µ—à–Ω—ã–π:**
```json
{
  "success": true,
  "message": "SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω",
  "debugCode": "1234"  // –¢–æ–ª—å–∫–æ –≤ development
}
```

**–û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:**
```json
{
  "success": false,
  "error": "–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ 45 —Å–µ–∫"
}
```

### 2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

**POST** `/api/sms/verify`

```json
{
  "phone": "79991234567",
  "code": "1234"
}
```

**–û—Ç–≤–µ—Ç —É—Å–ø–µ—à–Ω—ã–π:**
```json
{
  "success": true,
  "message": "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "phone": "79991234567",
    "isAuthenticated": true,
    "loginTime": 1754395450261
  }
}
```

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 1. üìß SMS –ü—Ä–æ–≤–∞–π–¥–µ—Ä (SMSC.ru)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local`:

```env
# SMS Configuration
SMSC_LOGIN=your_smsc_login
SMSC_PASSWORD=your_smsc_password

# JWT Secret (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É!)
JWT_SECRET=your-super-secret-jwt-key-here

NODE_ENV=production
```

### 2. üîì –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ SMS

–í —Ñ–∞–π–ª–µ `src/app/api/sms/send/route.ts` —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –±–ª–æ–∫:

```typescript
// –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å SMSC.ru —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ:
const response = await fetch('https://smsc.ru/sys/send.php', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/x-www-form-urlencoded',
  },
  body: new URLSearchParams({
    login: process.env.SMSC_LOGIN || '',
    psw: process.env.SMSC_PASSWORD || '',
    phones: phone,
    mes: text,
    fmt: '3', // JSON —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
    charset: 'utf-8'
  })
});

const result = await response.json();
return !result.error;
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã:

- **Rate Limiting**: 1 SMS –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –Ω–æ–º–µ—Ä
- **–ö–æ–¥ –∏—Å—Ç–µ–∫–∞–µ—Ç**: —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç
- **–ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫**: 3 –ø–æ–ø—ã—Ç–∫–∏ –≤–≤–æ–¥–∞ –∫–æ–¥–∞
- **JWT —Ç–æ–∫–µ–Ω—ã**: –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ 7 –¥–Ω–µ–π
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–æ–º–µ—Ä–∞ –∏ –∫–æ–¥–∞

### üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

–í—Å–µ SMS —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:
```
üì± SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ 79991234567: –¶–µ–Ω—Ç—Ä "–ì–∞—Ä–º–æ–Ω–∏—è":
–í–∞—à –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: 1234
–ù–µ —Å–æ–æ–±—â–∞–π—Ç–µ –µ–≥–æ –Ω–∏–∫–æ–º—É!
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **–û—Ç–ø—Ä–∞–≤–∫–∞ SMS**: –ª—é–±–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä
2. **–ö–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è**: –≤ –∂–µ–ª—Ç–æ–º –±–ª–æ–∫–µ –≤ –º–æ–¥–∞–ª–µ
3. **–õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏**: –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å SMS
curl -X POST http://localhost:3000/api/sms/send \
  -H "Content-Type: application/json" \
  -d '{"phone":"79991234567"}'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥  
curl -X POST http://localhost:3000/api/sms/verify \
  -H "Content-Type: application/json" \
  -d '{"phone":"79991234567","code":"1234"}'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
curl -X GET http://localhost:3000/api/sms/verify \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `AuthModal.tsx`:

1. **–í–≤–æ–¥ –Ω–æ–º–µ—Ä–∞** ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ `/api/sms/send`
2. **–ü–æ–∫–∞–∑ –∫–æ–¥–∞** (dev mode) ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  
3. **–í–≤–æ–¥ –∫–æ–¥–∞** ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ `/api/sms/verify`
4. **–£—Å–ø–µ—Ö** ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞, –ø–µ—Ä–µ—Ö–æ–¥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –§—É–Ω–∫—Ü–∏–∏:

- ‚úÖ **sendSMS()** - –æ—Ç–ø—Ä–∞–≤–∫–∞ SMS
- ‚úÖ **handleCodeSubmit()** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
- ‚úÖ **handleResendCode()** - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å —Ç–∞–π–º–µ—Ä–æ–º
- ‚úÖ **Error handling** - –∫—Ä–∞—Å–∏–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ **Success feedback** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å SMS

### SMSC.ru —Ç–∞—Ä–∏—Ñ—ã (–ø—Ä–∏–º–µ—Ä–Ω–æ):

- **–ü–æ –†–æ—Å—Å–∏–∏**: ~2-4 —Ä—É–±–ª—è –∑–∞ SMS
- **–ö—É–ø–∏—Ç—å –ø–∞–∫–µ—Ç**: –æ—Ç 1000 SMS = —Å–∫–∏–¥–∫–∞
- **API –±–µ—Å–ø–ª–∞—Ç–Ω–æ**: –ø–ª–∞—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ –∑–∞ SMS

### –†–∞—Å—á–µ—Ç –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞:

- **100 –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤/–º–µ—Å—è—Ü** = 200 SMS (–≤—Ö–æ–¥ + –ø–æ–≤—Ç–æ—Ä—ã)
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: ~400-800 —Ä—É–±–ª–µ–π/–º–µ—Å—è—Ü
- **–û–∫—É–ø–∞–µ—Ç—Å—è**: —Å –ø–µ—Ä–≤–æ–≥–æ –ø–ª–∞—Ç–Ω–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞! 

---

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**‚úÖ SMS API –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω**  
**‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞**  
**‚úÖ UI/UX –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω**  
**‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ**  

**üöÄ –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ SMSC.ru –∏ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!**